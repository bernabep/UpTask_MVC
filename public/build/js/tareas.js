!function(){let e=[],t=[];!async function(){try{const t=`http://localhost:3000/api/tareas?id=${c()}`,a=await fetch(t),n=await a.json();e=n.tareas,r()}catch(e){console.log(e)}}();const a=document.querySelector("#agregar-tarea");function n(a){const n=a.target.value;console.log(e),console.log(n),t=""!==n?e.filter((e=>e.estado==n)):[],r()}function o(t=!1,a={}){const n=document.createElement("DIV");n.classList.add("modal"),n.innerHTML=`\n    <form class='formulario nueva-tarea'>\n        <legend>${t?"Editar la Tarea":"Añade una nueva tarea"}</legend>\n        <div class="campo">\n            <label for="tarea">Tarea</label>\n            <input \n            type="text"\n            name="tarea"\n            id="tarea"\n            placeholder="${a.nombre?"Edita la Tarea":"Añadir Tarea al Proyecto Actual"}"\n            value="${t?a.nombre:""}"\n            />\n        </div>\n        <div class="opciones">\n            <input type="submit" class="submit-nueva-tarea" value="${t?"Editar Tarea":"Añadir Tarea"}"/>\n            <button type="button" class="cerrar-modal">Cancelar</button>\n        </div>\n    </form>    \n    `,setTimeout((()=>{document.querySelector(".formulario").classList.add("animar")}),0),n.addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("cerrar-modal")){document.querySelector(".formulario").classList.add("cerrar"),setTimeout((()=>{n.remove()}),500)}if(o.target.classList.contains("submit-nueva-tarea")){const o=document.querySelector("#tarea").value.trim();if(i(),""==o)return void function(e,t,a){const n=document.createElement("DIV");n.classList.add("alerta",t),n.textContent=e,a.parentElement.insertBefore(n,a.nextElementSibling),setTimeout((()=>{i()}),5e3)}("Es obligatorio Indicar la Tarea","error",document.querySelector(".formulario legend"));t?(a.nombre=o,d(a)):async function(t){const a=new FormData;a.append("nombre",t),a.append("proyectoId",c());try{const n="http://localhost:3000/api/tarea",o=await fetch(n,{method:"POST",body:a}),i=await o.json();if(Swal.fire({title:i.mensaje,icon:"success",draggable:!0}),"exito"===i.tipo){setTimeout((()=>{document.querySelector(".modal")}),3e3);const a={id:String(i.id),nombre:t,estado:"0",proyectoId:i.proyectoId};e=[...e,a],r()}}catch(e){console.log(e)}}(o),setTimeout((()=>{n.remove()}),500)}})),document.querySelector(".dashboard").appendChild(n)}function r(){!function(){const e=document.querySelector(".listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter((e=>"1"===e.estado)),a=document.querySelector("#completadas");0===t.length?a.disabled=!0:a.disabled=!1}(),function(){const t=e.filter((e=>"0"===e.estado)),a=document.querySelector("#pendientes");0===t.length?a.disabled=!0:a.disabled=!1}();const a=t.length?t:e,n=document.querySelector("#listado-tareas");if(0===a.length){const e=document.createElement("LI");e.textContent="No Hay Tareas",e.classList.add("no-tareas"),n.appendChild(e)}else{const t={0:"Pendiente",1:"Completa"};a.forEach((a=>{const i=document.createElement("LI");i.dataset.tareaId=a.id,i.classList.add("tarea");const s=document.createElement("P");s.textContent=a.nombre,s.ondblclick=function(){o(editar=!0,a={...a})};const l=document.createElement("DIV");l.classList.add("opciones");const u=document.createElement("BUTTON");u.classList.add("tarea-estado",t[a.estado].toLowerCase()),u.textContent=t[a.estado],u.dataset.estadoTarea=a.estado,u.ondblclick=function(){!function(e){e.estado="0"===e.estado?e.estado="1":e.estado="0",d(e)}({...a})},btnEliminarTarea=document.createElement("BUTTON"),btnEliminarTarea.classList.add("eliminar-tarea"),btnEliminarTarea.dataset.idTarea=a.id,btnEliminarTarea.textContent="Eliminar",btnEliminarTarea.ondblclick=function(){!function(t){Swal.fire({title:"Seguro que quieres eliminar la Tarea?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Eliminar Tarea",denyButtonText:"Cancelar"}).then((a=>{a.isConfirmed?async function(t){const{id:a,nombre:n,estado:o,proyectoId:i}=t,d=new FormData;d.append("id",a),d.append("nombre",n),d.append("estado",o),d.append("proyectoId",i),d.append("url",c());try{const t="http://localhost:3000/api/tarea/eliminar",n=await fetch(t,{method:"POST",body:d});"exito"===(await n.json()).respuesta.tipo&&(Swal.fire("Tarea Eliminada!","","success"),e=e.filter((e=>e.id!==a)),r())}catch(e){console.log(e)}}(t):a.isDenied&&Swal.fire("No se ha eliminado la tarea","","info")}))}({...a})},l.appendChild(u),l.appendChild(btnEliminarTarea),i.appendChild(s),i.appendChild(l),n.appendChild(i)}))}}function i(){document.querySelectorAll(".alerta").forEach((function(e,t,a){e.remove()}))}function c(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).id}async function d(t){const{id:a,nombre:n,estado:o,proyectoId:i}=t,d=new FormData;d.append("id",a),d.append("nombre",n),d.append("estado",o),d.append("proyectoId",i),d.append("url",c());try{const t="http://localhost:3000/api/tarea/actualizar",i=await fetch(t,{method:"POST",body:d}),c=await i.json();"exito"===c.respuesta.tipo&&(Swal.fire({title:c.respuesta.mensaje,icon:"success",draggable:!0}),e=e.map((e=>(e.id===a&&(e.estado=o,e.nombre=n),e))),r())}catch(e){console.log(e)}}document.querySelectorAll('#filtros input[type="radio"]').forEach((e=>{e.addEventListener("input",n)})),a.addEventListener("click",(function(){o()}))}();